# REST API

Приложение предоставляет контроллер REST-запросов, запускаемый с помощью
функции `run!` класса `CaseCore::API::REST::Controller`.

## Формат запросов и ответов

*   Контроллер REST-запросов поддерживает только GET-запросы.
*   Параметры запроса, если запрос поддерживает их, указываются в URL.
*   Возвращаемая информация кодируется с помощью JSON.
*   Контроллер возвращает HTTP-статус 200 (`ok`) в случае успешного выполнения
    запроса.
*   Контроллер возвращает HTTP-статус 404 (`not found`), если запрашиваемый
    ресурс не найден.
*   Контроллер возвращает HTTP-статус 422 (`unprocessable`), если параметры
    запроса не удовлетворяют схеме или если во время выполнения запроса
    произошла ошибка. При этом возвращается информация о классе созданного
    исключения и текст исключения.

## Описание

*   `POST /cases` — получение информации о заявках с помощью
    [механизма](./SEARCH.md) поиска записей. Поддерживает все параметры
    механизма, а также позволяет указывать названия извлекаемых полей и
    атрибутов с помощью параметра `fields`.

*   `GET /cases/:id` — получение информации о полях записи и атрибутах заявки с
    идентификатором записи `id`. Поддерживает параметр `names`, в котором можно
    указать список названий атрибутов заявки (если параметр отсутствует, то
    возвращаются все атрибуты).

*   `GET /cases/:id/documents` — получение информации о всех документах,
    прикреплённых к заявке с идентификатором записи `id`. Не поддерживает
    никаких параметров.

*   `POST /cases/:id/requests` — получение информации о всех межведомственных
    запросах, прикреплённых к заявке с идентификатором записи `id`, с помощью
    [механизма](./SEARCH.md) поиска записей. Поддерживает все параметры
    механизма, а также позволяет указывать названия извлекаемых полей и
    атрибутов с помощью параметра `fields`.

*   `POST /cases/:id/requests_count` — получение информации о количестве
    межведомственных запросов, прикреплённых к заявке с идентификатором записи
    `id`, с помощью [механизма](./SEARCH.md) поиска записей. Поддерживает все
    параметры механизма, кроме сортировки записей.

*   `POST /cases_count` — получение информации о количестве заявок с помощью
    [механизма](./SEARCH.md) поиска записей. Поддерживает все параметры
    механизма, кроме сортировки записей.

*   `POST /files` — создание записи файла с телом запроса в качестве
    содержимого. Не поддерживает никаких параметров.

*   `GET /files/:id` — получение содержимого файла с идентификатором записи
    `id`. Не поддерживает никаких параметров.

*   `PUT /files/:id` — выставление тела запроса в качестве содержимого файла с
    идентификатором записи `id`. Не поддерживает никаких параметров.

*   `GET /processing_statuses/:id` — получение информации о статусе обработки
    STOMP-сообщения со значением заголовка `x_message_id`, равным значению
    `id`. Не поддерживает никаких параметров.

*   `GET /version` — получение информации о версии приложения. При указании
    параметра `modules` с любым значением дополнительно возвращает информацию о
    модулях бизнес-логики и их версиях, собранную на основе директорий в
    директории с бизнес-логикой.
