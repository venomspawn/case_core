# Разработка модуля бизнес-логики: рекомендации и указания

*   Модуль бизнес-логики разрабатывается в составе библиотеки Ruby («гема») с
    использованием всех обычных правил разработки библиотек.

*   Название модуля бизнес-логики должно совпадать с названием библиотеки, из
    которого убраны символы `_`, без учёта регистра символов.

    Примеры:

    -   модуль `TestCase` в библиотеке `test_case` удовлетворяет правилу;
    -   модуль `MixedCASE` в библиотеке `mixed_case` удовлетворяет правилу;
    -   модуль `WontBeFoundСase` в библиотеке `xxx_w0nt_b3_f0und_c4s3_xxx` не
        удовлетворяет правилу.

*   При распаковке библиотеки бизнес-логики извлекаются все директории и файлы,
    кроме тех, чей путь в библиотеке начинается на `test` или `spec`.

    Примеры:

    -   директория с путём в библиотеке `spec/fixtures` не будет извлечена;
    -   файл с путём в библиотеке `test_data.dat` не будет извлечён;
    -   файл с путём в библиотеке `lib/test_case.rb` будет извлечён;
    -   файл с путём в библиотеке `resources/schemas/response_schema.json`
        будет извлечён.

*   При установке библиотеки бизнес-логики не устанавливаются никакие
    зависимости библиотеки.

*   Бизнес-логика может использовать возможности следующих библиотек:

    -   `activesupport`;
    -   `json-schema`;
    -   `rest-client`;
    -   `rufus-scheduler`;
    -   `stomp`.

*   Модулю бизнес-логики предоставляются следующие возможности приложения:

    -   подписка на очереди STOMP-сообщений;
    -   публикация STOMP-сообщений в очереди;
    -   осуществление запросов ко внешним ресурсам по протоколу HTTP;
    -   работа с записями в базе данных приложения;
    -   работа с действиями приложения.

*   Категорически не рекомендуется использовать глобальные переменные для
    хранения какой-либо информации, а также внедрять новые константы в
    пространство имён `Object`. Все используемые константы должны находиться
    либо в пространстве имён модуля бизнес-логики, либо в дочерних
    пространствах имён.

*   Крайне рекомендуется использовать событие о выгрузке модуля бизнес-логики,
    предоставляя функцию `on_unload` для освобождения запрошенных ресурсов,
    отписывания от очередей, удаления таймеров и так далее.

*   Рекомендуется использовать реализованные в приложении возможности,
    например, вместо подписки на очереди STOMP-сообщений с непосредственным
    использованием объектов библиотеки STOMP использовать функцию `subscribe`
    класса `CaseCore::API::STOMP::Controller`.
